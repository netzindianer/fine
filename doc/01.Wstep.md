# Wstep

## Instalacja

1. `$ git clone http://github.com/serafin/fine.git` (lub sciagnac zipa i rozpakowac)
2. `$ cp -a fine/src/* /var/www/vhosts/project1/html/`
3. http://project1.dev

Lub

Aktualna wersja bedzie zawsze na serwerze developerskim w katalogu /var/www/vhosts/fine2/

1. `$ cp -a /var/www/vhosts/fine2/src/* /var/www/vhosts/project1/html/`
2. http://project1.dev

## Standaryzacja

### Nazwy zmiennych

W argumentach method w bibliotece zmienne maja prefixy:

 - a - array
 - b - boolean
 - c - char
 - f - float
 - i - integer
 - k - callback
 - m - mixed
 - n - number
 - o - object
 - r - resource
 - s - string
 - t - const
 - u - null

np.

`f_m->select($aisParam = null);`

### Settery i gettery

```
<?php

class example
{

    protected $_param;

    public function param($sParam = null)
    {
        if (func_num_args() == 0) {
            return $this->_param;
        }
        $this->_param = $sParam;
        return $this;
    }

}
    
?>
```

### Unifikacja konstruktorow

Wszystkie konstruktory przyjmuja jeden parametr - konfiguracje. 
Jest to tablica gdzie kluczem jest nazwa metody, a wartoscia pierwszy argument metody.
Konstruktor uruchamia kazda podana metode przekazujac podany argument.
Dzieki temu nie ma potrzeby zapamietywania różnej liczby parametry, różnej kolejności, roznej opcjonalnosci
dla różnych klas.

```
<?php

class example
{

    public function __construct(array $config = array())
    {
        foreach ($config as $k => $v) {
            $this->{$k}($v);
        }
    }

}

?>
```


### Konstruktor statyczny

```
    <?php

    class example
    {

        public function __construct(array $config = array())
        {
            foreach ($config as $k => $v) {
                $this->{$k}($v);
            }
        }

        public static function _(array $config = array())
        {
            foreach ($config as $k => $v) {
                $this->{$k}($v);
            }
        }

    }

    example::_()->someMethod();
```


### Plynny kod

```
    <?php

    class example
    {

        public function __construct(array $config = array())
        {
            foreach ($config as $k => $v) {
                $this->{$k}($v);
            }
        }

        public static function _(array $config = array())
        {
            foreach ($config as $k => $v) {
                $this->{$k}($v);
            }
        }

        public function method1()
        {
            ...
            return $this;
        }

        public function method2()
        {
            ...
            return $this;
        }

        public function method3()
        {
            ...
            return $this;
        }

    }

    example::_()
        ->method1()
        ->method2()
        ->method3();
```

## Główny kontener aplikacji


f_di

```
    <?php

    class my_container extends f_di
    {

        protected function _serviceA()
        {
            return new stdClass();
        }

        protected function _serviceB()
        {
            return $this->serviceB = new stdClass();
        }

    }

    $oContainer = new my_container();
    $oService1  = $oContainer->serviceA;
    $oService2  = $oContainer->serviceA;
    $oService3  = $oContainer->serviceB;
    $oService4  = $oContainer->serviceB;
```


glowny kontener aplikacji

```
<?php

class f_c_container extends f_di
{
    // obsluga helperow f_c_helper_*
}

class container extends f_c_container
{

    protected function _v()
    {
        return $this->v = new f_v();
    }

    protected function _db()
    {
        $this->db = new f_db_mysql();
        $this->db->connct($this->config->main['db]['host'], ..., ...);
        $this->db->selectDb($this->config->main['db]['name']);
        $this->db->query("SET NAMES 'utf-8'");
        return $this->db;
    }

    ...


}

f::$c = new container();
```

(helpery tylko z f/c/helper sa ladowane, reszta trzeba sobie samemu ustawic)


kontroller

```
<?php

class foo extends f_c
{

    public function bar()
    {
        // $f::c == $this->_c;
        $this->_c->redirect->helper('http://ubuntu.com/');
        $this->redirect->helper('http://ubuntu.com/'); //f_c::__get('redirect')
        $this->redirect('http://ubuntu.com/'); //f_c::__call('redirect', 'http://ubuntu.com/')
    }

}
```

widok
```
<?= $this->_c->formText->helper('search'); ?>
<?= $this->formText->helper('search'); ?>
<?= $this->formText('search'); ?>
<?= $this->c->redirect('http://ubuntu.com/') ?>

```


struktura

```
f::$c; (container)
f::$c->db;
f::$c->v;
f::$c->v->c->v->c->redirect();
```

## Adresy

```
<?php

class container extends f_c_container
{

    protected function _uri()
    {
        $this->uri = new f_c_helper_uri();
    }

    protected function _uriBase()
    {
        return $this->uriBase = "/";
    }

}

class v_container extends f_v_container
{

    protected function _uri()
    {
        $this->uri = $this->c->uri;
    }

}


$oUri = f::$c->uri;

print_r($oUri->resolve('/controller/action/param1/value1/param2/value2'));

Array
    (
        [0] => controller
        [1] => action
        [2] => param1
        [3] => value1
        [4] => param2
        [5] => value2
        [controller] => action
        [param1] => value1
        [param2] => value2
    )


print_r($oUri->helper(array('controller', 'action', 'param1', 'value1', 'param2', 'value2'));

/controller/action/param1/value1/param2/value2

```



## Drzewo plikow

```
/var/www/vhosts/project1/html/
app/
    c/
        data.php
        error.php
        index.php
        public.php
        setup.php
    config/
        main.php
        data.php [news][img][size] = array('t320x260')
        public.php [css][style.css][v] = 1
    m/
    v/
        helper/
        layout/
        script/
            index/
                index.php
        container.php
    container.php
cache/
    aa/
    ab/
data/
    model1/
        {model1_id}_{model1_token}.jpg
    model2/
        {model2_id}_{model2_token}.{model_ext}
lib/
    f/
    f.php
public/
    css/
        style.css/
            box-users.css
tmp/

```

